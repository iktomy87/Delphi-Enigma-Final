Object subclass: #DelphiEnigma	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!DelphiEnigma class	instanceVariableNames: ''!!DelphiEnigma class methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 19:53'!jugar    | juego |    juego := MainMenu new.      juego openInWorld.  ! !Morph subclass: #EnemigoTablero	instanceVariableNames: 'position allPositions sprite'	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!!EnemigoTablero methodsFor: 'initialization' stamp: 'Tomy 11/17/2024 07:06'!initializeAt: initialPosition    position := initialPosition.    sprite := self createSpriteAt: initialPosition withColor: Color red.! !!EnemigoTablero methodsFor: 'geometry' stamp: 'Tomy 11/17/2024 05:55'!position ^position! !!EnemigoTablero methodsFor: 'accessing' stamp: 'Tomy 11/17/2024 06:37'!sprite^sprite! !!EnemigoTablero methodsFor: 'accessing' stamp: 'Tomy 11/17/2024 06:32'!createSpriteAt: aPosition withColor: aColor    | circle squareSize circlePosition |    squareSize := 640 // 4.    circlePosition := ((aPosition x * squareSize) @ (aPosition y * squareSize)) + ((squareSize // 2) @ (squareSize // 2)).    circle := EllipseMorph new.    circle color: aColor.    circle bounds: (circlePosition - ((squareSize // 4) @ (squareSize // 4)) corner: circlePosition + ((squareSize // 4) @ (squareSize // 4))).    ^circle.! !Morph subclass: #JuegosInterfaz	instanceVariableNames: 'gameOver gameEndCallback score'	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!!JuegosInterfaz methodsFor: 'accessing' stamp: 'Tomy 11/24/2024 04:17'!puntaje^score! !!JuegosInterfaz methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 04:16'!verificarPuntaje    (score = 12 and: gameOver not) ifTrue: [        self terminarJuego.    ].! !!JuegosInterfaz methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 12:23'!terminarJuego    gameOver ifTrue: [^self].      gameOver := true.  	    gameEndCallback ifNotNil: [gameEndCallback value].    UIManager default inform: 'Tu puntaje es: ', score asString.    	self owner ifNotNil: [        self owner takeKeyboardFocus.    ].    self delete.! !!JuegosInterfaz methodsFor: 'enumerating' stamp: 'Tomy 11/24/2024 04:17'!whenGameEndsDo: aBlock    gameEndCallback := aBlock.! !Morph subclass: #JugadorTablero	instanceVariableNames: 'position sprite vidas'	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!!JugadorTablero methodsFor: 'geometry' stamp: 'Tomy 11/17/2024 05:54'!position^position! !!JugadorTablero methodsFor: 'accessing' stamp: 'Tomy 11/17/2024 07:14'!createSpriteAt: aPosition withColor: aColor    | circle squareSize circlePosition |    squareSize := 640 // 4.    circlePosition := ((aPosition x * squareSize) @ (aPosition y * squareSize)) + ((squareSize // 2) @ (squareSize // 2)).    circle := EllipseMorph new.    circle color: aColor.    circle bounds: (circlePosition - ((squareSize // 4) @ (squareSize // 4)) corner: circlePosition + ((squareSize // 4) @ (squareSize // 4))).    ^circle.! !!JugadorTablero methodsFor: 'accessing' stamp: 'Tomy 11/17/2024 06:37'!sprite^sprite! !!JugadorTablero methodsFor: 'accessing' stamp: 'Tomy 11/17/2024 08:53'!vidas: unaVidavidas:= unaVida! !!JugadorTablero methodsFor: 'accessing' stamp: 'Tomy 11/17/2024 10:54'!vidas^vidas ifNil: [vidas := 1].! !!JugadorTablero methodsFor: 'initialization' stamp: 'Tomy 11/17/2024 11:57'!initializeAt: initialPosition		position:= initialPosition.		vidas:= 1.    sprite := self createSpriteAt: initialPosition withColor: Color blue.! !Morph subclass: #MainMenu	instanceVariableNames: 'background'	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!!MainMenu methodsFor: 'initialization' stamp: 'TomasRodriguez 11/8/2024 02:02'!initialize    super initialize.    self extent: 400 @ 400.  "Tama‚àö¬±o del men‚àö‚à´"    self createBackground.    self createButtons.! !!MainMenu methodsFor: 'as yet unclassified' stamp: 'Tomy 11/17/2024 09:58'!playGame    "Mostrar el tablero y cerrar el men‚àö‚à´"    Introduccion new openInWorld.    self delete.  "Cierra el men‚àö‚à´ del juego"! !!MainMenu methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/8/2024 02:13'!createBackground    "Cargar y mostrar la imagen de fondo"    background:= ImageMorph new.    background image: (Form fromFileNamed: 'MainMenuWT.png').     background extent: 640 @ 640.	background bounds: (0 @ 0 corner: 640 @ 640).    self extent: 640 @ 640.  "Ajusta el tama‚àö¬±o del men‚àö‚à´"    self addMorph: background.! !!MainMenu methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/8/2024 02:25'!createButtons    | playButton exitButton |        "Bot‚àö‚â•n Jugar"    playButton := SimpleButtonMorph new.    playButton label: 'Jugar'.	playButton color: Color black.		playButton extent: 100 @ 50.    playButton position: 270 @ 250.    playButton on: #mouseUp send: #playGame to: self.    self addMorph: playButton.    "Bot‚àö‚â•n Salir"    exitButton := SimpleButtonMorph new.    exitButton label: 'Salir'.	exitButton color: Color black.	exitButton extent: 100 @ 50.    exitButton position: 270 @ 320.    exitButton on: #mouseUp send: #exitGame to: self.    self addMorph: exitButton.! !!MainMenu methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/8/2024 02:04'!exitGame    "Cerrar el men‚àö‚à´ del juego"    self delete.! !MainMenu subclass: #Introduccion	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!!Introduccion methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 19:47'!playGame    Tablero new openInWorld.    self delete. ! !!Introduccion methodsFor: 'as yet unclassified' stamp: 'Tomy 11/17/2024 09:57'!createBackground    "Cargar y mostrar la imagen de fondo"    background:= ImageMorph new.    background image: (Form fromFileNamed: 'Introduccion.png').     background extent: 640 @ 640.	background bounds: (0 @ 0 corner: 640 @ 640).    self extent: 640 @ 640.  "Ajusta el tama‚àö¬±o del men‚àö‚à´"    self addMorph: background.! !!Introduccion methodsFor: 'as yet unclassified' stamp: 'Tomy 11/17/2024 09:59'!createButtons    | continue |        "Bot‚àö‚â•n Jugar"    continue := SimpleButtonMorph new.    continue label: 'Continuar'.	continue color: Color black.		continue extent: 100 @ 50.    continue position: 270 @ 350.    continue on: #mouseUp send: #playGame to: self.    self addMorph: continue.! !Morph subclass: #Tablero	instanceVariableNames: 'selectedEnemyPosition enemigos jugador capturedEnemies allEnemiesPos'	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!!Tablero methodsFor: 'as yet unclassified' stamp: 'Tomy 11/22/2024 05:30'!adjacentPositionsTo: position    | x y possiblePositions validPositions |    x := position x.    y := position y.        "Generar todas las posibles posiciones adyacentes (8 direcciones)"    possiblePositions := {        (x - 1)@(y - 1). (x - 1)@y. (x - 1)@(y + 1).        x@(y - 1).               x@(y + 1).        (x + 1)@(y - 1). (x + 1)@y. (x + 1)@(y + 1).    }.    "Filtrar solo posiciones v√°lidas dentro del tablero (0 <= x, y <= 3)"    validPositions := possiblePositions select: [:pos |         (pos x between: 0 and: 3) and: (pos y between: 0 and: 3)    ].    ^validPositions! !!Tablero methodsFor: 'as yet unclassified' stamp: 'TomasRodriguez 11/8/2024 01:35'!createSquares    | squareSize squareColor square creamColor |    squareSize := self width // 4.  "Deber‚àö‚â†a ser 100 si width es 400"        "Definir el color crema"    creamColor := Color r: 1.0 g: 0.95 b: 0.8.        0 to: 3 do: [ :row |        0 to: 3 do: [ :col |            "Determinar color en base a la paridad de la fila y columna"            squareColor := ((row + col) even) ifTrue: [Color veryLightGray] ifFalse: [creamColor].                        "Crear y configurar cada cuadrado"            square := Morph new.            square color: squareColor.                        "Establecer los l‚àö‚â†mites de cada cuadrado"            square bounds: ((col * squareSize) @ (row * squareSize) extent: (squareSize @ squareSize)).                        "Agregar cuadrado al tablero"            self addMorph: square        ]    ].! !!Tablero methodsFor: 'as yet unclassified' stamp: 'Tomy 11/17/2024 06:31'!colorEnemy: position to: aColor    | enemy |    enemy := enemigos detect: [:e | e position = position] ifNone: [nil].    enemy ifNotNil: [enemy sprite color: aColor].! !!Tablero methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 21:09'!moveSelection: direction    | newSelectedPosition adjacentToJugador adjacentToCapturedEnemies allAdjacentPositions isValidPosition |    "Obtener posiciones adyacentes al jugador como una colecci√≥n mutable"    adjacentToJugador := (self adjacentPositionsTo: jugador position) asOrderedCollection.    "Obtener todas las posiciones adyacentes a los enemigos capturados"    adjacentToCapturedEnemies := capturedEnemies flatCollect: [:enemyPos |         self adjacentPositionsTo: enemyPos    ].    "Combinar todas las posiciones adyacentes y eliminar duplicados"    allAdjacentPositions := adjacentToJugador.    allAdjacentPositions addAll: adjacentToCapturedEnemies.    allAdjacentPositions := allAdjacentPositions asSet asOrderedCollection.    "Excluir posiciones que correspondan a enemigos capturados o no seleccionables"    allAdjacentPositions := allAdjacentPositions reject: [:pos | capturedEnemies includes: pos].    "Mover en la direcci√≥n especificada hasta encontrar una posici√≥n v√°lida"    isValidPosition := false.    newSelectedPosition := selectedEnemyPosition + direction.    [        (((newSelectedPosition x between: 0 and: 3)             and: (newSelectedPosition y between: 0 and: 3))             and: (allAdjacentPositions includes: newSelectedPosition))         and: [(capturedEnemies includes: newSelectedPosition) not]    ] whileFalse: [        "Seguir moviendo en la direcci√≥n especificada"        newSelectedPosition := newSelectedPosition + direction.        "Romper el bucle si sale de los l√≠mites del tablero"        ((newSelectedPosition x < 0 or: [newSelectedPosition x > 3])             or: [newSelectedPosition y < 0 or: [newSelectedPosition y > 3]]) ifTrue: [                isValidPosition := false.                ^self.        ].    ].    "Restaurar color del enemigo previo si no es capturado"    (capturedEnemies includes: selectedEnemyPosition) ifFalse: [        self colorEnemy: selectedEnemyPosition to: Color red.    ].    "Actualizar la posici√≥n seleccionada"    selectedEnemyPosition := newSelectedPosition.    isValidPosition := true.    self colorEnemy: selectedEnemyPosition to: Color green.! !!Tablero methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 19:48'!startRandomGame    | randomChoice quiz space spacePuntaje carrera carreraPuntaje batalla batallaPuntaje|    randomChoice := #(#Quiz #SpaceInvaders Juego_Carreras Batalla) atRandom.    randomChoice caseOf: {        [#Quiz] -> [            quiz := Quiz new.            quiz iniciar.            self endGameWithScore: quiz puntaje.            self takeKeyboardFocus.  "Restablecer foco al tablero despu√©s del quiz"        ].        [#SpaceInvaders] -> [            space := SpaceInvaders new.            space iniciarSI.  "Inicia el juego de Space Invaders"            space takeKeyboardFocus.  "Dar foco a Space Invaders"				space whenGameEndsDo: [						spacePuntaje:= space puntaje.                self endGameWithScore: spacePuntaje.                self takeKeyboardFocus.             ].          self takeKeyboardFocus.         ].		  [#Juego_Carreras] -> [            carrera  := Juego_Carreras new.            carrera openInWorld.              carrera takeKeyboardFocus.  				carrera whenGameEndsDo: [						carreraPuntaje:= carrera puntaje.                self endGameWithScore: carreraPuntaje.                self takeKeyboardFocus.             ].          self takeKeyboardFocus.         ].			 [#Batalla] -> [            batalla  := Batalla new.            batalla openInWorld.              batalla takeKeyboardFocus. 				batalla whenGameEndsDo: [						batallaPuntaje:= batalla puntaje.                self endGameWithScore: batallaPuntaje.                self takeKeyboardFocus.             ].          self takeKeyboardFocus.         ].	    } otherwise: [].! !!Tablero methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 21:08'!gameState    (jugador vidas <= 0) ifTrue: [        GameOver new openInWorld.        self delete.        ^self.  "Terminar ejecuci√≥n aqu√≠"    ].    (jugador vidas >= 16) ifTrue: [        WinScreen new openInWorld.        self delete.        ^self.  "Terminar ejecuci√≥n aqu√≠"    ].! !!Tablero methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 20:51'!endGameWithScore: score    | adjacentEnemies notCaptured lastPosition lastCapturedEnemy |    (score >= 12) ifTrue: [        self colorEnemy: selectedEnemyPosition to: Color blue.        capturedEnemies add: selectedEnemyPosition.        allEnemiesPos remove: selectedEnemyPosition.        lastPosition := selectedEnemyPosition.        "Incrementar las vidas del jugador"        jugador vidas: jugador vidas + 1.        "Seleccionar un nuevo enemigo para destacar"        adjacentEnemies := self adjacentPositionsTo: selectedEnemyPosition.        notCaptured := adjacentEnemies select: [:pos |             (allEnemiesPos includes: pos) and: (capturedEnemies includes: pos) not        ].        notCaptured isEmpty ifFalse: [            selectedEnemyPosition := notCaptured first.            self colorEnemy: selectedEnemyPosition to: Color green.        ].    ] ifFalse: [        jugador vidas: jugador vidas - 1.        "Verificar si hay enemigos capturados para revertir"        capturedEnemies isEmpty ifFalse: [            lastCapturedEnemy := capturedEnemies last.            self colorEnemy: lastCapturedEnemy to: Color red.            allEnemiesPos add: lastCapturedEnemy.            capturedEnemies remove: lastCapturedEnemy.        ].    ].    self takeKeyboardFocus.    self gameState.self terminateProcess.! !!Tablero methodsFor: 'as yet unclassified' stamp: 'Tomy 11/22/2024 05:28'!adjacentEnemy    | adjacentEnemies |    adjacentEnemies := self adjacentPositionsTo: jugador position.	Transcript show: adjacentEnemies; cr.    "Verificamos si alguna de las posiciones adyacentes tiene un enemigo"    ^ adjacentEnemies detect: [:pos | allEnemiesPos includes: pos] ifNone: [nil].! !!Tablero methodsFor: 'adding' stamp: 'Tomy 11/17/2024 08:27'!initializeEnemies    | allPositions selectedPosition|    allPositions := (0 to: 3) flatCollect: [:row |         (0 to: 3) collect: [:col | row @ col]    ].    selectedPosition:= allPositions reject: [:pos | pos = jugador position].	 ^selectedPosition collect: [:pos |        EnemigoTablero new initializeAt: pos    ].! !!Tablero methodsFor: 'initialize-release' stamp: 'Tomy 11/21/2024 04:00'!terminateProcess Process allInstances do: [:each |    each suspendedContext ifNotNil: [        | receiver |        receiver := each suspendedContext receiver.        (receiver notNil and: [            (receiver class name = 'DelaySemaphoreScheduler')             or: [receiver class name = 'Delay']        ]) ifTrue: [            each terminate.        ].    ].].! !!Tablero methodsFor: 'event handler' stamp: 'Tomy 11/24/2024 06:02'!handlesKeyboard    ^ true! !!Tablero methodsFor: 'initialization' stamp: 'Tomy 11/24/2024 19:48'!initialize    | cream randomPosition|    super initialize.    cream := Color r: 1.0 g: 0.95 b: 0.8.    self color: cream.    self extent: 640@640. "Tama√±o del tablero"    randomPosition:= (0 to: 3) atRandom @ (0 to: 3) atRandom.    jugador := JugadorTablero new initializeAt: randomPosition.    self createSquares.    self addMorph: jugador sprite.		    enemigos := self initializeEnemies.    capturedEnemies := OrderedCollection new.	allEnemiesPos:= OrderedCollection new.	capturedEnemies add: jugador position.    enemigos do: [:enemy | self addMorph: enemy sprite. allEnemiesPos add: enemy position].    selectedEnemyPosition := self adjacentEnemy.	    selectedEnemyPosition ifNotNil: [self colorEnemy: selectedEnemyPosition to: Color green].	Transcript show: selectedEnemyPosition; cr.    self takeKeyboardFocus.! !!Tablero methodsFor: 'event handling' stamp: 'Tomy 11/24/2024 20:42'!handlesMouseDown: anEvent    ^ true.! !!Tablero methodsFor: 'event handling' stamp: 'Tomy 11/24/2024 21:08'!handleKeystroke: anEvent    anEvent keyValue caseOf: {        [28] -> [self moveSelection: (-1 @ 0)].  "Izquierda"        [30] -> [self moveSelection: (0 @ -1)].  "Arriba"        [29] -> [self moveSelection: (1 @ 0)].   "Derecha"        [31] -> [self moveSelection: (0 @ 1)].   "Abajo"        [13] -> [            (allEnemiesPos includes: selectedEnemyPosition) ifTrue: [                self startRandomGame.                "Recuperar el enfoque en el tablero despu√©s de ejecutar el juego"                self takeKeyboardFocus.            ].        ]  "Enter para iniciar el juego si hay un enemigo seleccionado"    } otherwise: [].! !!Tablero methodsFor: 'event handling' stamp: 'Tomy 11/24/2024 20:41'!mouseUp: anEvent    super mouseUp: anEvent.    self takeKeyboardFocus.! !MainMenu subclass: #WinScreen	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!!WinScreen methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 19:47'!playGame    Tablero new openInWorld.    self delete.  ! !!WinScreen methodsFor: 'as yet unclassified' stamp: 'Tomy 11/17/2024 09:04'!createBackground    "Cargar y mostrar la imagen de fondo"    background:= ImageMorph new.    background image: (Form fromFileNamed: 'WinScreen.png').     background extent: 640 @ 640.	background bounds: (0 @ 0 corner: 640 @ 640).    self extent: 640 @ 640.  "Ajusta el tama‚àö¬±o del men‚àö‚à´"    self addMorph: background.! !!WinScreen methodsFor: 'as yet unclassified' stamp: 'Tomy 11/17/2024 20:05'!createButtons    | playButton exitButton |        "Bot‚àö‚â•n Jugar"    playButton := SimpleButtonMorph new.    playButton label: 'Jugar de nuevo'.	playButton color: Color black.		playButton extent: 100 @ 50.    playButton position: 270 @ 350.    playButton on: #mouseUp send: #playGame to: self.    self addMorph: playButton.    "Bot‚àö‚â•n Salir"    exitButton := SimpleButtonMorph new.    exitButton label: 'Salir'.	exitButton color: Color black.	exitButton extent: 100 @ 50.    exitButton position: 270 @ 420.    exitButton on: #mouseUp send: #exitGame to: self.    self addMorph: exitButton.! !!WinScreen methodsFor: 'as yet unclassified' stamp: 'Tomy 11/17/2024 09:05'!exitGame    "Cerrar el men‚àö‚à´ del juego"    self delete.! !WinScreen subclass: #GameOver	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'JuegoPrincipal'!!GameOver methodsFor: 'as yet unclassified' stamp: 'Tomy 11/24/2024 19:47'!createBackground    "Cargar y mostrar la imagen de fondo"    background:= ImageMorph new.    background image: (Form fromFileNamed: 'GameOver.png').     background extent: 640 @ 640.	background bounds: (0 @ 0 corner: 640 @ 640).    self extent: 640 @ 640.      self addMorph: background.! !